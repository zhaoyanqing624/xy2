import catchScreen
import getOffset
import random
import time
import autopy3 as autopy
import getScreen
import fiter

def newPlayerStart():
    autopy.mouse.move(100, 20)  # 平滑移动鼠标（上面那个是瞬间的）
    autopy.mouse.click()  # 单击
    while True:
        catchScreen.catchAllScreen()
        if(isinstance(getOffset.getOffsetValue("new\\begin"), list)):
            break
    # 点击第一个任务 npc仙子
    attr = getOffset.getOffsetValue("new\\begin")
    fiter.moveAndClick(attr[0]-20+random.randint(-20,20),attr[1]-10)
    fiter.isWalking()
    fiter.moveAndClick(250+random.randint(-10,20),329)
    time.sleep(1)
    fiter.isAuto()
    # 关闭大话精灵对话框
    fiter.moveAndClick(652, 165)
    # 点击第二个任务 npc王二愣
    fiter.moveAndClick(40+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(218+random.randint(-10,20), 328)
    fiter.isAuto
    # 点击第三个任务 npc猎户
    print("任务3")
    fiter.moveAndClick(80+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(218+random.randint(-10,20), 328)
    fiter.isAuto()
    fiter.moveAndClick(655, 165)

    # 点击第四个任务 npc小黄金兽
    print("任务4")
    fiter.moveAndClick(78+random.randint(-20,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(207+random.randint(-10,20), 328)
    fiter.isFight()
    fiter.isAuto()
    # 点击第五个任务 npc猎户
    time.sleep(0.5)
    fiter.moveAndClick(80+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-15,15), 328)
    fiter.isAuto()
    # 点击第六个任务 npc渔村村子
    time.sleep(0.5)
    fiter.moveAndClick(70+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-15,15), 328)
    fiter.isAuto()
    # 点击第七个任务 npc王二愣
    fiter.moveAndClick(65+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-15,15), 328)
    fiter.isAuto()
    # 点击第八个任务 npc渔村村长
    time.sleep(1)
    fiter.moveAndClick(88+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-20,20), 328)
    fiter.isAuto()
    # 点击第九个任务 npc大侠
    time.sleep(1)
    fiter.moveAndClick(60+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-15,15), 328)
    fiter.isAuto()
    # 点击第十个任务 npc渔村村长
    time.sleep(1)
    fiter.moveAndClick(100+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-15,15), 328)
    fiter.isAuto()
    # 礼包中心
    time.sleep(1)
    fiter.moveAndClick(229, 368)
    time.sleep(1)
    fiter.moveAndClick(229, 368)
    # 点击第十一个任务 npc服装店老板
    time.sleep(1)
    fiter.moveAndClick(70+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(170+random.randint(0,5), 328)
    fiter.isAuto()
    # 点击第十二个任务 npc仙子姐姐
    time.sleep(1)
    fiter.moveAndClick(142+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(185+random.randint(-15,15), 328)
    fiter.isAuto()
    time.sleep(1)
    # 点击第十三个任务 npc王大妈
    fiter.moveAndClick(161+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-20,20), 328)
    fiter.isAuto()
    # 服用摄妖香
    fiter.moveAndClick(330, 400)
    # 点击第十四个任务 npc隐藏的妖怪
    time.sleep(1)
    fiter.moveAndClick(136+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(185+random.randint(-20,20), 328)
    fiter.isAuto()
    # 穿装备
    time.sleep(1)
    autopy.key.toggle('e', True, autopy.key.MOD_ALT)
    autopy.key.toggle('e', False, autopy.key.MOD_ALT)
    fiter.moveAndClick_fast2(258, 410)
    fiter.moveAndClick_fast2(308, 410)
    fiter.moveAndClick_fast2(50, 460)
    fiter.moveAndClick_fast2(100, 460)
    fiter.moveAndClick_fast2(150, 460)
    time.sleep(1)
    autopy.key.toggle('e', True, autopy.key.MOD_ALT)
    autopy.key.toggle('e', False, autopy.key.MOD_ALT)
    # 点击第十六个任务 npc妖怪
    time.sleep(1)
    fiter.moveAndClick(130+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(185+random.randint(-15,15), 328)
    fiter.isFight()
    fiter.isAuto()
    # 点击第十六个任务 npc王二愣
    time.sleep(1)
    fiter.moveAndClick(40+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(185+random.randint(-20,20), 328)
    fiter.isAuto()
    # 点击第十七个任务 npc 小小
    time.sleep(1)
    fiter.moveAndClick(50+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(170+random.randint(0,5), 328)
    fiter.isAuto()
    fiter.moveAndClick(105+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(195+random.randint(-15,15), 328)
    fiter.isAuto()
    # 点击第十八个任务 npc鬼婆婆
    time.sleep(1)
    fiter.moveAndClick(135+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(185+random.randint(-15,15), 344)
    fiter.isAuto()
    fiter.moveAndClick(100+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(185+random.randint(-20,20), 328)
    fiter.isAuto()
    fiter.moveAndClick(65+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(190+random.randint(-20,20), 344)
    fiter.isAuto()
    fiter.moveAndClick(125+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(185+random.randint(-15,15), 328)
    fiter.isAuto()
    fiter.moveAndClick(50+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(222+random.randint(-25,25), 344)
    fiter.isAuto()
    # 点击第十九个任务 npc道士
    time.sleep(1)
    fiter.moveAndClick(50+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(190+random.randint(-20,20), 328)
    fiter.isAuto()
    fiter.moveAndClick(55+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(240+random.randint(-10,20), 344)
    fiter.isAuto()
    fiter.moveAndClick(60+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(190+random.randint(-15,15), 328)
    fiter.isFight()
    fiter.moveAndClick(190+random.randint(0,50), 328)
    # 点击第二十个任务 npc仙子姐姐
    time.sleep(1)
    fiter.moveAndClick(60+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(190+random.randint(-20,20), 328)
    fiter.isAuto()
    fiter.moveAndClick(80+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(195+random.randint(-20,20), 328)
    fiter.isAuto()
    fiter.moveAndClick(100+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(230+random.randint(-20,20), 328)
    fiter.isAuto()
    fiter.moveAndClick(95+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(215+random.randint(-20,20), 344)
    fiter.isAuto()
    fiter.moveAndClick(115+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-15,15), 344)
    fiter.isAuto()
    fiter.moveAndClick(55+random.randint(-10,10), 240)
    fiter.isWalking()
    autopy.key.toggle('5', True, autopy.key.MOD_ALT)
    autopy.key.toggle('5', False, autopy.key.MOD_ALT)
    time.sleep(2)
    fiter.moveAndClick(200+random.randint(0,50), 328)
    fiter.moveAndClick(65+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(200+random.randint(-15,15), 328)
    fiter.isAuto()
    fiter.moveAndClick(80+random.randint(-10,20), 240)
    fiter.isWalking()
    fiter.moveAndClick(222+random.randint(-20,20), 328)
    fiter.isAuto()
    fiter.moveAndClick(100+random.randint(0,5), 240)
    fiter.isWalking()
    fiter.moveAndClick(222+random.randint(-20,20), 328)
    fiter.isAuto()
    fiter.moveAndClick(60+random.randint(0,5), 240)
    fiter.moveAndClick(230+random.randint(-20,20), 328)
    # 渔夫考验
    test_yufu = 0
    while True:
        if((test_yufu%3) == 0):
            fiter.moveAndClick(175, 328)
        elif((test_yufu%3) == 1):
            fiter.moveAndClick(175, 344)
        else:
            fiter.moveAndClick(175, 364)
        catchScreen.catchAllScreen()
        if (isinstance(getOffset.getOffsetValue("new\\auto"), list)):
            break
        test_yufu+=1
    fiter.isAuto()
    # 点击第二十一个任务 npc袁天罡
    fiter.moveAndClick(55+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(185+random.randint(-10,10), 328)
    fiter.moveAndClick(229, 368)
    time.sleep(1)
    fiter.moveAndClick(229, 368)
    fiter.moveAndClick(490, 400)
    fiter.isAuto()
    fiter.moveAndClick(55+random.randint(-10,10), 240)
    fiter.moveAndClick(185+random.randint(-10,10), 328)
    autopy.key.toggle('j', True, autopy.key.MOD_ALT)
    autopy.key.toggle('j', False, autopy.key.MOD_ALT)
    time.sleep(2)
    fiter.moveAndClick(338, 376)
    time.sleep(1)
    fiter.moveAndClick(338+random.randint(0,50), 376)
    time.sleep(1)
    fiter.moveAndClick(185+random.randint(-10,10), 344)
    fiter.moveAndClick(55+random.randint(-10,10), 240)
    fiter.moveAndClick(185+random.randint(-10,10), 344)
    time.sleep(1)
    autopy.key.toggle('f', True, autopy.key.MOD_ALT)
    autopy.key.toggle('f', False, autopy.key.MOD_ALT)
    fiter.moveAndClick(734+random.randint(-10,10), 196)
    fiter.moveAndClick(579+random.randint(-10,10), 513)
    # 郭三才
    time.sleep(1)
    fiter.moveAndClick(55+random.randint(-10,10), 240)
    fiter.isWalking()
    fiter.moveAndClick(253+random.randint(-10,10), 343)
    fiter.moveAndClick(77+random.randint(-10,10), 240)
    fiter.moveAndClick(205+random.randint(-10,10), 358)
newPlayerStart()
